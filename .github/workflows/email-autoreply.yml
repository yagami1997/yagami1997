name: Auto Reply to Email Requests

on:
  issues:
    types: [opened]
  workflow_dispatch: # æ·»åŠ æ‰‹åŠ¨è§¦å‘é€‰é¡¹

permissions:
  issues: write
  contents: read

jobs:
  auto-reply:
    runs-on: ubuntu-latest
    # ä¿®æ”¹æ¡ä»¶åˆ¤æ–­ï¼Œä½¿å®ƒæ›´å¯èƒ½åŒ¹é…æˆ–æ·»åŠ skipæ¡ä»¶æ–¹ä¾¿è°ƒè¯•
    if: "contains(github.event.issue.title, 'Email') || contains(github.event.issue.title, 'email') || github.event_name == 'workflow_dispatch'"
    steps:
      - name: Auto Reply to Email Request
        uses: actions/github-script@v6
        with:
          script: |
            // å¦‚æžœæ˜¯æ‰‹åŠ¨è§¦å‘è€Œéžissueè§¦å‘ï¼Œåˆ™è·³è¿‡è¯„è®ºéƒ¨åˆ†
            if (context.eventName === 'workflow_dispatch') {
              console.log('Workflow manually triggered - test mode');
              return;
            }
            
            const issueNumber = context.issue.number;
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              body: `### ðŸ” Secure Communication Channel ðŸ”

Thank you for reaching out! To be honest, it takes some effort to get my GPG email information. Let's Rock!

#### ðŸ“§ Email Address:
\`\`\`
isaac787.mo@gmail.com
\`\`\`

#### ðŸ”‘ GPG Key Instructions:
\`\`\`bash
# Import my public key from keyserver
gpg --keyserver hkps://keys.openpgp.org --recv-keys D22BC844F1646033

# Verify fingerprint before sending sensitive data
gpg --fingerprint D22BC844F1646033
\`\`\`

*This is an automated response. I'll close this issue shortly to keep things tidy.*

![End-to-End Encrypted](https://img.shields.io/badge/E2E-Encrypted-00C853?style=flat-square&logo=gnuprivacyguard&logoColor=white)`
            });
            
            // æ·»åŠ å»¶è¿Ÿï¼Œç¡®ä¿ç”¨æˆ·æœ‰æ—¶é—´çœ‹åˆ°æ¶ˆæ¯
            await new Promise(resolve => setTimeout(resolve, 5000));
            
            // å…³é—­issue
            await github.rest.issues.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              state: 'closed'
            });
