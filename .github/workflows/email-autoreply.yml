name: Auto Reply to Email Requests

on:
  issues:
    types: [opened]

permissions:
  issues: write
  contents: read

jobs:
  auto-reply:
    runs-on: ubuntu-latest
    if: contains(github.event.issue.title, 'Email Request')
    steps:
      - name: Auto Reply to Email Request
        uses: actions/github-script@v6
        with:
          script: |
            const issueNumber = context.issue.number;
            await github.rest.issues.createComment({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              body: `Thank you for your interest in contacting me securely!
              
              Here's my email address: \`isaac787.mo@gmail.com\`
              
              Please remember to encrypt your message using my GPG key:
              \`\`\`bash
              # Import my public key from keyserver
              gpg --keyserver hkps://keys.openpgp.org --recv-keys D22BC844F1646033
              
              # Verify fingerprint before sending sensitive data
              gpg --fingerprint D22BC844F1646033
              \`\`\`
              
              This is an automated response. I'll close this issue shortly to keep things tidy.`
            });
            
            // Close the issue
            await github.rest.issues.update({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: issueNumber,
              state: 'closed'
            });
